<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head}"></head>
<body>
<!-- Navigation -->
<nav th:insert="~{layout :: nav}"></nav>

<!-- Main Content -->
<div class="container">
    <div class="main-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="header-title">
                <i class="fas fa-list"></i>
                Todo Lists
            </h1>
            <div class="create-dropdown">
                <div class="btn btn-primary create-btn">
                    <i class="fas fa-plus"></i>
                    Create New
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-content">
                    <a th:href="@{/lists/new}" class="dropdown-item">
                        <i class="fas fa-list"></i>
                        Todo List
                    </a>
                    <a th:href="@{/notes/new}" class="dropdown-item">
                        <i class="fas fa-sticky-note"></i>
                        Note
                    </a>
                </div>
            </div>
        </div>

        <!-- No Items Message -->
        <div th:if="${dashboardItems == null or #lists.isEmpty(dashboardItems)}" class="empty-state">
            <i class="fas fa-inbox"></i>
            <h4>No content yet</h4>
            <p>Create your first todo list or note to get started!</p>
        </div>

        <!-- Unified Dashboard Items -->
        <div class="cards-container" th:if="${dashboardItems != null and not #lists.isEmpty(dashboardItems)}">
            <div class="card" th:each="item : ${dashboardItems}">
                <div class="card-body clickable-card"
                     role="button"
                     tabindex="0"
                     th:data-url="${item.entityType.name() == 'TODOLIST' ? '/lists/' + item.id : '/notes/' + item.id}"
                     onclick="window.location.href = this.dataset.url"
                >
                    <div class="card-header">
                        <div class="card-type">
                            <i th:class="${item.entityType.name() == 'TODOLIST' ? 'fas fa-list' : 'fas fa-sticky-note'}"></i>
                            <span class="type-label" th:text="${item.entityType.name() == 'TODOLIST' ? 'Todo List' : 'Note'}"></span>
                        </div>
                        <h2 class="card-title" th:text="${item.title}"></h2>
                    </div>

                    <!-- Progress badge (only for TodoLists) -->
                    <div th:if="${item.entityType.name() == 'TODOLIST'}" class="badge">
                        <span th:text="${item.progressString}"></span>
                    </div>

                    <!-- Preview text -->
                    <p class="note-preview" th:text="${item.preview}"></p>

                    <div class="card-timestamp">
                        <span th:text="${@timeUtil.lastEdited(item.updatedAt)}">Last edited</span>
                    </div>
                </div>

                <!-- Card Footer with Actions -->
                <div class="card-footer">
                    <!-- Conditional delete URL based on item type -->
                    <a th:href="${item.entityType.name() == 'TODOLIST' ? '/lists/' + item.id + '/delete-confirm' : '/notes/' + item.id + '/delete-confirm'}"
                       class="btn btn-outline-danger btn-sm">
                        <i class="fas fa-trash"></i>
                        Delete
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:insert="~{layout :: fab}"></div>
</body>
</html>